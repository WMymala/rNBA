---
title: "Bball Shooting Correlations - 49 Leagues"
author: "Walter Mymala"
date: "8/9/2021"
output: html_document
---

** Dataset from Jacob Baruch on Kaggle.com:https://www.kaggle.com/jacobbaruch/basketball-players-stats-per-season-49-leagues 

Contains stats scraped from 49 basketball leagues from around the world 
from 1949 to 2020**

```{r echo = F, results = 'hide'}
library(tidyverse)
library(dplyr)
library(ggplot2)

D <- read.csv("~/Desktop/MoneyBall/players_stats_by_season_full_details.csv")

D$FGPct = D$FGM / D$FGA # include FG% in dataset and order it in column neatly
D$FTPct = D$FTM / D$FTA # include FT% ...
D$X3Pct = D$X3PM / D$X3PA # include X3P% ...

D = D %>% select(League, Season, Stage, Player, Team, GP, MIN, FGM, FGA, FGPct, X3PM, X3PA, X3Pct, FTM, FTA, FTPct, TOV, PF, ORB, DRB, REB, AST, STL, BLK, PTS, birth_date, birth_year, birth_month, height, height_cm, weight, weight_kg, nationality, high_school,  draft_round, draft_pick, draft_team)

head(D)
```

```{r}
## 
unique(D$League, incomparables = FALSE)
```

**The Euroleague and Eurocup is bascally like soccer's Champions League and Europa Laegue in that it consists of having top European teams playing one another. These teams play in these respective leagues as well as their own domestic league concurrently. This may affect the data.**

** The European professional club basketball system starting in 2018**

From Reddit:
13 teams have a contract and they participate no matter what. These teams are Real Madrid(ESP), Barcelona(ESP), Baskonia(ESP), Olimpia Milano(ITA), Zalgiris(LTU), Panathinaikos(GRC), Olympiacos(GRC), Panathinaikos(GRC), Fenerbahce(TUR), Anadolu Efes(TUR), CSKA Moscow(RUS), LDLC ASVEL(FRA) and Maccabi Tel Aviv(ISR).

The 7 spots left :

The winner of eurocup (second tier European competition)

The winner of ABA league (league based on former countries of Yuguslavia: Bosnia and Herzegovina, Croatia, Macedonia, Montenegro, Serbia (including the regions of Kosovo and Vojvodina) and Slovenia)

The winner or runner up of VTB(Russian) league (usually CSKA wins, so the second team from VTB)

wildcard places lasting 2-years or 1-year

The winner of BBL ( German league).

```{r}
# subset from dataframe just the NBA in 2019-2020 regular season with statistical minimums to qualify for NBA League Leaders to limit outliers: 

NBA19_20R <- D %>% filter(League == "NBA", Season == "2019 - 2020", FTA >= 125) # observations drop from 360 to 125 after adding statistical minimum
head(NBA19_20R)

plot(NBA19_20R$X3Pct, NBA19_20R$FTPct, xlab = '3 Point %', ylab = 'Free Throw %')

## subset dataframe of the second best league in the 2019-2020 regular season according to ESPN with statistical minimums to qualify for Leagues Leaders(Euroleague players must play 51% of games to be in league leaders, so 34 â€¢ .51 = 17.34 is 18 games minimum)

EuroL19_20R <- D %>% filter(League == "Euroleague", Season == "2019 - 2020", GP >= 18)
# observations drop from 237 to 183 after adding statistical minimum

NBAxEuroL19_20R <- rbind(NBA19_20R, EuroL19_20R) # merge data
```
From our data, ignoring the outliers near 0.0 3 point % and 0.6 3 point %, there is no clear pattern to indicate relationship between 3 point % and free throw %. Let's do a scatterplot, but with ggplot. 

```{r}
## working w/ ggplot
ggplot(NBAxEuroL19_20R, aes(x = X3Pct, y = FTPct, col = League)) + geom_point() 
```
```{r}
# also want to represent points by mapping so individual dot changes depending on PTS variable(NBA plays more games than Euroleague)
ggplot(NBAxEuroL19_20R, aes(x = X3Pct, y = FTPct, col = League, size = PTS)) + geom_point() + scale_color_manual(values = c("NBA" = "blue", "Euroleague" = "orange")) + geom_smooth(method = lm, se = FALSE)

cor(NBAxEuroL19_20R$X3Pct, NBAxEuroL19_20R$FTPct)
```

The scatter plot data shows no apparent relationship between 3-point shooting and free throw percentage since there is no linear pattern. Due to this, the regression line might not have any use here. We can tell since the correlation between the two functions is N/A.

```{r}
# map FTPct to transparency of each point
## ggplot(NBAxEuroL19_20R) + geom_point(aes(x = X3Pct, y = FTPct, col = League, size = PTS, shape = League, alpha = FTPct)) + scale_color_manual(values = c("NBA" = "blue", "Euroleague" = "orange"))
```

```{r}
# histograms
ggplot(NBAxEuroL19_20R, aes(x = FTPct)) + 
  geom_histogram(bins = 30) + geom_histogram(color="black", fill="white") 

# overlaid and separated by league
ggplot(NBAxEuroL19_20R, aes(x = FTPct, fill = League, color = League)) +
  geom_histogram(alpha = 0.5, position = "identity") + scale_color_manual(values=c("orange", "blue")) +
  theme(legend.position="bottom") 
```


